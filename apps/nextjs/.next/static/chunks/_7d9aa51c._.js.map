{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/andreicruceru/comment.video/apps/nextjs/src/hooks/useMultipartUpload.tsx"],"sourcesContent":["import { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport mimeDb from \"mime-db\";\n\nimport { toast } from \"@acme/ui/toast\";\n\nimport { useTRPC } from \"~/trpc/react\";\n\n// import * as Sentry from \"@sentry/nextjs\";\n\nconst CHUNK_SIZE = 5 * 1024 * 1024;\n\n/**\n * Gets the file extension from a MIME type using mime-db\n * @param mimeType The MIME type of the file\n * @returns The extension without the leading dot, or 'bin' as fallback\n */\nconst getExtensionFromMimeType = (mimeType: string): string => {\n  const mime = mimeDb[mimeType];\n  if (mime && mime.extensions && mime.extensions.length > 0) {\n    // This ensures we don't get undefined\n    return mime.extensions[0] as string;\n  }\n\n  // Fallback extensions for common video types if mime-db doesn't have them\n  const fallbackMap: Record<string, string> = {\n    \"video/mp4\": \"mp4\",\n    \"video/webm\": \"webm\",\n    \"video/quicktime\": \"mov\",\n    \"video/x-msvideo\": \"avi\",\n    \"video/x-matroska\": \"mkv\",\n  };\n\n  const fallbackExt = fallbackMap[mimeType];\n  return fallbackExt !== undefined ? fallbackExt : \"bin\"; // Default to .bin if no extension found\n};\n\nexport interface UploadState {\n  uploaded: number;\n  total: number;\n  percentage: number;\n  error: string | null;\n}\n\nexport interface CompletedPart {\n  ETag: string;\n  PartNumber: number;\n}\n\ninterface MultipartConfig {\n  videoId: string;\n  onError?: (error: Error) => void;\n  onProgress?: (state: UploadState) => void;\n  createdAt?: string;\n  fileExtension?: string;\n}\n\nexport const useMultipartUpload = () => {\n  const trpc = useTRPC();\n\n  const queryClient = useQueryClient();\n  const { mutateAsync: initiateUpload } = useMutation(\n    trpc.aws.initiateMultipartUpload.mutationOptions({\n      onSuccess: async () => {\n        // form.reset();\n        // await queryClient.invalidateQueries(trpc.post.pathFilter());\n      },\n      onError: (err) => {\n        toast.error(\n          err.data?.code === \"UNAUTHORIZED\"\n            ? \"You must be logged in to post\"\n            : \"Failed to create post\",\n        );\n      },\n    }),\n  );\n  const { mutateAsync: completeUpload } = useMutation(\n    trpc.aws.completeMultipartUpload.mutationOptions({\n      onSuccess: async () => {\n        await queryClient.invalidateQueries(trpc.video.pathFilter());\n      },\n    }),\n  );\n\n  const uploadPart = async (\n    chunk: Blob,\n    url: string,\n    partNumber: number,\n    retries = 3,\n  ): Promise<CompletedPart> => {\n    try {\n      const response = await fetch(url, {\n        method: \"PUT\",\n        body: chunk,\n      });\n\n      if (!response.ok) {\n        throw new Error(`Upload failed with status ${response.status}`);\n      }\n\n      const eTag = response.headers.get(\"etag\") || response.headers.get(\"ETag\");\n      if (!eTag) {\n        throw new Error(\"No ETag received\");\n      }\n\n      return {\n        ETag: eTag.replace(/^\"(.*)\"$/, \"$1\"),\n        PartNumber: partNumber,\n      };\n    } catch (err) {\n      if (retries > 0) {\n        await new Promise((resolve) => setTimeout(resolve, 1000));\n        return uploadPart(chunk, url, partNumber, retries - 1);\n      }\n      throw err;\n    }\n  };\n\n  const uploadFile = async (\n    file: File,\n    config: MultipartConfig,\n  ): Promise<string> => {\n    try {\n      const initialState: UploadState = {\n        uploaded: 0,\n        total: file.size,\n        percentage: 0,\n        error: null,\n      };\n\n      config.onProgress?.(initialState);\n\n      // Get file extension with multiple fallbacks\n      let fileExtension = config.fileExtension;\n\n      // If not provided in config, try to extract from filename\n      if (!fileExtension) {\n        fileExtension = file.name.split(\".\").pop();\n      }\n\n      // If still not available, use MIME type to determine\n      if (!fileExtension) {\n        fileExtension = getExtensionFromMimeType(file.type);\n      }\n\n      // If we still don't have a valid extension, show error\n      if (!fileExtension || fileExtension.trim() === \"\") {\n        const error = new Error(\"Cannot determine file extension\");\n        toast.error(\"Failed to upload: Cannot determine file type\");\n\n        if (config.onError) {\n          config.onError(error);\n        }\n\n        throw error;\n      }\n\n      const chunks = Math.ceil(file.size / CHUNK_SIZE);\n      const { uploadId: multipartUploadId, signedUrls } = await initiateUpload({\n        videoId: config.videoId,\n        contentLength: file.size,\n        parts: chunks,\n        fileExtension,\n      });\n\n      const uploads = signedUrls.map(({ url, partNumber }) => {\n        const start = (partNumber - 1) * CHUNK_SIZE;\n        const end = Math.min(start + CHUNK_SIZE, file.size);\n        const chunk = file.slice(start, end);\n        return uploadPart(chunk, url, partNumber);\n      });\n\n      // Track progress of all uploads\n      let completedSize = 0;\n      const progressPromises = uploads.map(async (promise, index) => {\n        await promise;\n        completedSize += Math.min(CHUNK_SIZE, file.size - index * CHUNK_SIZE);\n        config.onProgress?.({\n          uploaded: completedSize,\n          total: file.size,\n          percentage: Math.round((completedSize / file.size) * 100),\n          error: null,\n        });\n      });\n\n      // Wait for all uploads and progress updates\n      const [parts] = await Promise.all([\n        Promise.all(uploads),\n        Promise.all(progressPromises),\n      ]);\n\n      await completeUpload({\n        videoId: config.videoId,\n        uploadId: multipartUploadId,\n        parts,\n        fileExtension,\n      });\n\n      return config.videoId;\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error(\"Upload failed\");\n      const errorMessage = error.message;\n\n      config.onProgress?.({\n        uploaded: 0,\n        total: file.size,\n        percentage: 0,\n        error: errorMessage,\n      });\n\n      if (config.onError) {\n        config.onError(error);\n      }\n\n      //   Sentry.captureException(err);\n      throw error;\n    }\n  };\n\n  return {\n    uploadFile,\n  };\n};\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 189, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 195, "column": 0}, "map": {"version":3,"sources":["file:///Users/andreicruceru/comment.video/apps/nextjs/src/app/%28dashboard%29/_components/video-dropzone.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useCallback, useState } from \"react\";\nimport Image from \"next/image\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { useDropzone } from \"react-dropzone\";\n\nimport { cn } from \"@acme/ui\";\nimport { Button } from \"@acme/ui/button\";\nimport { Progress } from \"@acme/ui/progress\";\nimport { toast } from \"@acme/ui/toast\";\n\nimport type { UploadState } from \"~/hooks/useMultipartUpload\";\nimport { useMultipartUpload } from \"~/hooks/useMultipartUpload\";\nimport { useTRPC } from \"~/trpc/react\";\n\ninterface VideoDropzoneProps {\n  onUploadComplete?: (videoId: string) => void;\n  className?: string;\n}\n\nexport function VideoDropzone({\n  onUploadComplete,\n  className,\n}: VideoDropzoneProps) {\n  const trpc = useTRPC();\n  const { mutateAsync: createVideo } = useMutation(\n    trpc.video.create.mutationOptions(),\n  );\n\n  const [uploadState, setUploadState] = useState<UploadState>({\n    uploaded: 0,\n    total: 0,\n    percentage: 0,\n    error: null,\n  });\n  const [isUploading, setIsUploading] = useState(false);\n  const { uploadFile } = useMultipartUpload();\n\n  const onDrop = useCallback(\n    async (acceptedFiles: File[]) => {\n      const file = acceptedFiles[0];\n\n      if (!file) return;\n\n      // Validate file type\n      if (!file.type.startsWith(\"video/\")) {\n        toast.error(\"Please upload a video file\");\n        return;\n      }\n\n      try {\n        setIsUploading(true);\n        // Generate a unique ID for this video\n\n        const newVideoId = await createVideo({\n          title: file.name,\n        });\n\n        const id = newVideoId[0]?.id;\n\n        if (!id) {\n          throw new Error(\"Failed to create video\");\n        }\n\n        // Start upload\n        const uploadedVideoId = await uploadFile(file, {\n          videoId: id,\n          onProgress: (state) => {\n            setUploadState(state);\n            if (state.error) {\n              toast.error(`Upload failed: ${state.error}`);\n              setIsUploading(false);\n            }\n          },\n          onError: (error) => {\n            toast.error(`Upload error: ${error.message}`);\n            setIsUploading(false);\n          },\n        });\n\n        toast.success(\"Video uploaded successfully!\");\n        onUploadComplete?.(uploadedVideoId);\n        setIsUploading(false);\n      } catch (error) {\n        // Error is already handled by onError callback\n        setIsUploading(false);\n      }\n    },\n    [uploadFile, onUploadComplete],\n  );\n\n  const { getRootProps, getInputProps, isDragActive } = useDropzone({\n    onDrop,\n    accept: {\n      \"video/*\": [],\n    },\n    multiple: false,\n    disabled: isUploading,\n  });\n\n  return (\n    <div className={cn(\"w-full\", className)}>\n      <div\n        {...getRootProps()}\n        className={cn(\n          \"relative flex w-full cursor-pointer flex-col items-center justify-center overflow-hidden rounded-lg border-2 border-dashed p-6\",\n          isDragActive ? \"border-primary bg-primary/10\" : \"border-border\",\n          isUploading && \"pointer-events-none opacity-60\",\n        )}\n      >\n        <input {...getInputProps()} />\n\n        {isUploading && (\n          <div className=\"absolute inset-0 z-30 flex w-full flex-col items-center justify-center bg-background\">\n            <div className=\"mx-auto flex w-full max-w-sm flex-col gap-2\">\n              <div className=\"mb-1 flex items-center justify-between\">\n                <p className=\"text-sm font-medium\">Uploading video...</p>\n                <span className=\"text-sm\">\n                  {uploadState.percentage.toFixed(0)}%\n                </span>\n              </div>\n              <Progress value={uploadState.percentage} className=\"h-2 w-full\" />\n              <p className=\"text-xs text-muted-foreground\">\n                {(uploadState.uploaded / (1024 * 1024)).toFixed(2)} MB of{\" \"}\n                {(uploadState.total / (1024 * 1024)).toFixed(2)} MB\n              </p>\n            </div>\n          </div>\n        )}\n        <>\n          <div className=\"pointer-events-none absolute inset-0 opacity-20\">\n            <Image\n              fill\n              src=\"/video-placeholder.png\"\n              className=\"object-cover\"\n              alt=\"Video placeholder\"\n            />\n          </div>\n          <div className=\"flex flex-col items-center justify-center\">\n            <p className=\"mb-2 text-sm font-medium\">\n              {isDragActive\n                ? \"drop the video here\"\n                : \"drag and drop a video file, or click to browse\"}\n            </p>\n            <p className=\"text-xs text-muted-foreground\">\n              supports most video formats (MP4, MOV, AVI, etc.)\n            </p>\n            <Button variant=\"outline\" className=\"mt-4\">\n              add your video\n            </Button>\n          </div>\n        </>\n      </div>\n\n      {uploadState.error && (\n        <div className=\"mt-4 rounded border border-destructive bg-destructive/10 p-3 text-sm text-destructive\">\n          {uploadState.error}\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 464, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 470, "column": 0}, "map": {"version":3,"sources":["file:///Users/andreicruceru/comment.video/apps/nextjs/src/utils/cdn.ts"],"sourcesContent":["export const getCDNUrl = (path: string) => {\n  // Split at second \"/\" to get the actual path\n  const parts = path.split(\"/\");\n  const cleanPath = parts.slice(3).join(\"/\");\n  console.log(cleanPath);\n\n  return `${process.env.NEXT_PUBLIC_CDN_URL}/video/${cleanPath}`;\n};\n"],"names":[],"mappings":";;;AAMY;AANL,MAAM,YAAY,CAAC;IACxB,6CAA6C;IAC7C,MAAM,QAAQ,KAAK,KAAK,CAAC;IACzB,MAAM,YAAY,MAAM,KAAK,CAAC,GAAG,IAAI,CAAC;IACtC,QAAQ,GAAG,CAAC;IAEZ,OAAO,iEAAmC,OAAO,EAAE,WAAW;AAChE","debugId":null}},
    {"offset": {"line": 484, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 490, "column": 0}, "map": {"version":3,"sources":["file:///Users/andreicruceru/comment.video/apps/nextjs/src/app/%28dashboard%29/_components/video-list/video-actions-dropdown.tsx"],"sourcesContent":["import React from \"react\";\nimport { MoreVertical, Pencil, Trash2 } from \"lucide-react\";\n\nimport { Button } from \"@acme/ui/button\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from \"@acme/ui/dropdown-menu\";\n\ninterface VideoActionsDropdownProps {\n  videoId: string;\n  onRename: () => void;\n  onDelete: (videoId: string) => void;\n}\n\nexport const VideoActionsDropdown: React.FC<VideoActionsDropdownProps> = ({\n  videoId,\n  onRename,\n  onDelete,\n}) => {\n  return (\n    <DropdownMenu>\n      <DropdownMenuTrigger asChild>\n        <Button variant=\"ghost\" size=\"sm\" className=\"h-8 w-8 p-0\">\n          <MoreVertical className=\"h-4 w-4\" />\n          <span className=\"sr-only\">Open menu</span>\n        </Button>\n      </DropdownMenuTrigger>\n      <DropdownMenuContent align=\"end\">\n        <DropdownMenuItem onClick={onRename}>\n          <Pencil className=\"mr-2 h-4 w-4\" />\n          <span>Rename</span>\n        </DropdownMenuItem>\n        <DropdownMenuSeparator />\n        <DropdownMenuItem\n          className=\"text-red-600 focus:text-red-600\"\n          onClick={() => onDelete(videoId)}\n        >\n          <Trash2 className=\"mr-2 h-4 w-4\" />\n          <span>Delete</span>\n        </DropdownMenuItem>\n      </DropdownMenuContent>\n    </DropdownMenu>\n  );\n};\n"],"names":[],"mappings":";;;;AACA;AAAA;AAAA;AAEA;AACA;;;;;AAcO,MAAM,uBAA4D,CAAC,EACxE,OAAO,EACP,QAAQ,EACR,QAAQ,EACT;IACC,qBACE,6LAAC,6IAAA,CAAA,eAAY;;0BACX,6LAAC,6IAAA,CAAA,sBAAmB;gBAAC,OAAO;0BAC1B,cAAA,6LAAC,mIAAA,CAAA,SAAM;oBAAC,SAAQ;oBAAQ,MAAK;oBAAK,WAAU;;sCAC1C,6LAAC,6NAAA,CAAA,eAAY;4BAAC,WAAU;;;;;;sCACxB,6LAAC;4BAAK,WAAU;sCAAU;;;;;;;;;;;;;;;;;0BAG9B,6LAAC,6IAAA,CAAA,sBAAmB;gBAAC,OAAM;;kCACzB,6LAAC,6IAAA,CAAA,mBAAgB;wBAAC,SAAS;;0CACzB,6LAAC,yMAAA,CAAA,SAAM;gCAAC,WAAU;;;;;;0CAClB,6LAAC;0CAAK;;;;;;;;;;;;kCAER,6LAAC,6IAAA,CAAA,wBAAqB;;;;;kCACtB,6LAAC,6IAAA,CAAA,mBAAgB;wBACf,WAAU;wBACV,SAAS,IAAM,SAAS;;0CAExB,6LAAC,6MAAA,CAAA,SAAM;gCAAC,WAAU;;;;;;0CAClB,6LAAC;0CAAK;;;;;;;;;;;;;;;;;;;;;;;;AAKhB;KA7Ba","debugId":null}},
    {"offset": {"line": 613, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 619, "column": 0}, "map": {"version":3,"sources":["file:///Users/andreicruceru/comment.video/packages/ui/src/dialog.tsx"],"sourcesContent":["\"use client\";\n\nimport * as React from \"react\";\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\";\nimport { Cross2Icon } from \"@radix-ui/react-icons\";\n\nimport { cn } from \".\";\n\nconst Dialog = DialogPrimitive.Root;\n\nconst DialogTrigger = DialogPrimitive.Trigger;\n\nconst DialogPortal = DialogPrimitive.Portal;\n\nconst DialogClose = DialogPrimitive.Close;\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className,\n    )}\n    {...props}\n  />\n));\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName;\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className,\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <Cross2Icon className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n));\nDialogContent.displayName = DialogPrimitive.Content.displayName;\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className,\n    )}\n    {...props}\n  />\n);\nDialogHeader.displayName = \"DialogHeader\";\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className,\n    )}\n    {...props}\n  />\n);\nDialogFooter.displayName = \"DialogFooter\";\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className,\n    )}\n    {...props}\n  />\n));\nDialogTitle.displayName = DialogPrimitive.Title.displayName;\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n));\nDialogDescription.displayName = DialogPrimitive.Description.displayName;\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogTrigger,\n  DialogClose,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n};\n"],"names":[],"mappings":";;;;;;;;;;;;;AAEA;AACA;AACA;AAEA;AANA;;;;;;AAQA,MAAM,SAAS,qKAAA,CAAA,OAAoB;AAEnC,MAAM,gBAAgB,qKAAA,CAAA,UAAuB;AAE7C,MAAM,eAAe,qKAAA,CAAA,SAAsB;AAE3C,MAAM,cAAc,qKAAA,CAAA,QAAqB;AAEzC,MAAM,8BAAgB,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,EAGnC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,qKAAA,CAAA,UAAuB;QACtB,KAAK;QACL,WAAW,CAAA,GAAA,iIAAA,CAAA,KAAE,AAAD,EACV,0JACA;QAED,GAAG,KAAK;;;;;;KAVP;AAaN,cAAc,WAAW,GAAG,qKAAA,CAAA,UAAuB,CAAC,WAAW;AAE/D,MAAM,8BAAgB,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,QAGnC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE,oBACpC,6LAAC;;0BACC,6LAAC;;;;;0BACD,6LAAC,qKAAA,CAAA,UAAuB;gBACtB,KAAK;gBACL,WAAW,CAAA,GAAA,iIAAA,CAAA,KAAE,AAAD,EACV,+fACA;gBAED,GAAG,KAAK;;oBAER;kCACD,6LAAC,qKAAA,CAAA,QAAqB;wBAAC,WAAU;;0CAC/B,6LAAC,mLAAA,CAAA,aAAU;gCAAC,WAAU;;;;;;0CACtB,6LAAC;gCAAK,WAAU;0CAAU;;;;;;;;;;;;;;;;;;;;;;;;;AAKlC,cAAc,WAAW,GAAG,qKAAA,CAAA,UAAuB,CAAC,WAAW;AAE/D,MAAM,eAAe,CAAC,EACpB,SAAS,EACT,GAAG,OACkC,iBACrC,6LAAC;QACC,WAAW,CAAA,GAAA,iIAAA,CAAA,KAAE,AAAD,EACV,sDACA;QAED,GAAG,KAAK;;;;;;MATP;AAYN,aAAa,WAAW,GAAG;AAE3B,MAAM,eAAe,CAAC,EACpB,SAAS,EACT,GAAG,OACkC,iBACrC,6LAAC;QACC,WAAW,CAAA,GAAA,iIAAA,CAAA,KAAE,AAAD,EACV,iEACA;QAED,GAAG,KAAK;;;;;;MATP;AAYN,aAAa,WAAW,GAAG;AAE3B,MAAM,4BAAc,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,QAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,qKAAA,CAAA,QAAqB;QACpB,KAAK;QACL,WAAW,CAAA,GAAA,iIAAA,CAAA,KAAE,AAAD,EACV,qDACA;QAED,GAAG,KAAK;;;;;;;AAGb,YAAY,WAAW,GAAG,qKAAA,CAAA,QAAqB,CAAC,WAAW;AAE3D,MAAM,kCAAoB,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,QAGvC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,qKAAA,CAAA,cAA2B;QAC1B,KAAK;QACL,WAAW,CAAA,GAAA,iIAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;;AAGb,kBAAkB,WAAW,GAAG,qKAAA,CAAA,cAA2B,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 764, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 770, "column": 0}, "map": {"version":3,"sources":["file:///Users/andreicruceru/comment.video/packages/ui/src/label.tsx"],"sourcesContent":["import type { VariantProps } from \"class-variance-authority\";\nimport * as React from \"react\";\nimport * as LabelPrimitive from \"@radix-ui/react-label\";\nimport { cva } from \"class-variance-authority\";\n\nimport { cn } from \"@acme/ui\";\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\",\n);\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n));\nLabel.displayName = LabelPrimitive.Root.displayName;\n\nexport { Label };\n"],"names":[],"mappings":";;;;AACA;AACA;AACA;AAEA;;;;;;AAEA,MAAM,gBAAgB,CAAA,GAAA,mKAAA,CAAA,MAAG,AAAD,EACtB;AAGF,MAAM,sBAAQ,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,OAI3B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,oKAAA,CAAA,OAAmB;QAClB,KAAK;QACL,WAAW,CAAA,GAAA,iIAAA,CAAA,KAAE,AAAD,EAAE,iBAAiB;QAC9B,GAAG,KAAK;;;;;;;AAGb,MAAM,WAAW,GAAG,oKAAA,CAAA,OAAmB,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 802, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 808, "column": 0}, "map": {"version":3,"sources":["file:///Users/andreicruceru/comment.video/packages/ui/src/form.tsx"],"sourcesContent":["\"use client\";\n\nimport type * as LabelPrimitive from \"@radix-ui/react-label\";\nimport type {\n  ControllerProps,\n  FieldPath,\n  FieldValues,\n  UseFormProps,\n} from \"react-hook-form\";\nimport type { ZodType, ZodTypeDef } from \"zod\";\nimport * as React from \"react\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { Slot } from \"@radix-ui/react-slot\";\nimport {\n  useForm as __useForm,\n  Controller,\n  FormProvider,\n  useFormContext,\n} from \"react-hook-form\";\n\nimport { cn } from \"@acme/ui\";\n\nimport { Label } from \"./label\";\n\nconst useForm = <\n  TOut extends FieldValues,\n  TDef extends ZodTypeDef,\n  TIn extends FieldValues,\n>(\n  props: Omit<UseFormProps<TIn>, \"resolver\"> & {\n    schema: ZodType<TOut, TDef, TIn>;\n  },\n) => {\n  const form = __useForm<TIn, unknown, TOut>({\n    ...props,\n    resolver: zodResolver(props.schema, undefined),\n  });\n\n  return form;\n};\n\nconst Form = FormProvider;\n\ninterface FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>,\n> {\n  name: TName;\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue | null>(\n  null,\n);\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>,\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  );\n};\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext);\n  const itemContext = React.useContext(FormItemContext);\n  const { getFieldState, formState } = useFormContext();\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\");\n  }\n  const fieldState = getFieldState(fieldContext.name, formState);\n\n  const { id } = itemContext;\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  };\n};\n\ninterface FormItemContextValue {\n  id: string;\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue,\n);\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId();\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  );\n});\nFormItem.displayName = \"FormItem\";\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField();\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  );\n});\nFormLabel.displayName = \"FormLabel\";\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } =\n    useFormField();\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  );\n});\nFormControl.displayName = \"FormControl\";\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField();\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-[0.8rem] text-muted-foreground\", className)}\n      {...props}\n    />\n  );\n});\nFormDescription.displayName = \"FormDescription\";\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField();\n  const body = error ? String(error.message) : children;\n\n  if (!body) {\n    return null;\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-[0.8rem] font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  );\n});\nFormMessage.displayName = \"FormMessage\";\n\nexport {\n  useForm,\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n};\n\nexport { useFieldArray } from \"react-hook-form\";\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1031, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1050, "column": 0}, "map": {"version":3,"sources":["file:///Users/andreicruceru/comment.video/apps/nextjs/src/app/%28dashboard%29/_components/video-list/video-rename-dialog.tsx"],"sourcesContent":["import { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { z } from \"zod\";\n\nimport { RouterOutputs } from \"@acme/api\";\nimport { Button } from \"@acme/ui/button\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@acme/ui/dialog\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  useForm,\n} from \"@acme/ui/form\";\nimport { Input } from \"@acme/ui/input\";\nimport { toast } from \"@acme/ui/toast\";\n\nimport { useTRPC } from \"~/trpc/react\";\n\ninterface RenameDialogProps {\n  video: RouterOutputs[\"video\"][\"all\"][number];\n  isOpen: boolean;\n  onOpenChange: (open: boolean) => void;\n}\n\nconst RenameDialog = ({ video, isOpen, onOpenChange }: RenameDialogProps) => {\n  const trpc = useTRPC();\n  const queryClient = useQueryClient();\n\n  const form = useForm({\n    defaultValues: {\n      title: video.title,\n    },\n    schema: z.object({\n      title: z.string().min(1, \"Title cannot be empty\"),\n    }),\n  });\n\n  const renameVideo = useMutation(\n    trpc.video.rename.mutationOptions({\n      onSuccess: async () => {\n        await queryClient.invalidateQueries(trpc.video.pathFilter());\n        toast.success(\"Video renamed successfully\");\n        onOpenChange(false);\n      },\n      onError: (err) => {\n        toast.error(\n          err.data?.code === \"UNAUTHORIZED\"\n            ? \"You must be logged in to rename a video\"\n            : \"Failed to rename video\",\n        );\n      },\n    }),\n  );\n\n  const onSubmit = (data: { title: string }) => {\n    console.log(\"onSubmit\", data, video);\n    renameVideo.mutate({ id: video.id, title: data.title.trim() });\n  };\n\n  return (\n    <Dialog open={isOpen} onOpenChange={onOpenChange}>\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle>Rename Video</DialogTitle>\n        </DialogHeader>\n        <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmit)}>\n            <div className=\"grid gap-4 py-4\">\n              <FormField\n                control={form.control}\n                name=\"title\"\n                render={({ field }) => (\n                  <FormItem className=\"grid grid-cols-4 items-center gap-4\">\n                    <FormLabel className=\"col-span-1\">Title</FormLabel>\n                    <FormControl>\n                      <Input {...field} className=\"col-span-3\" autoFocus />\n                    </FormControl>\n                  </FormItem>\n                )}\n              />\n            </div>\n            <DialogFooter>\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                onClick={() => onOpenChange(false)}\n              >\n                Cancel\n              </Button>\n              <Button type=\"submit\" disabled={renameVideo.isPending}>\n                {renameVideo.isPending ? \"Saving...\" : \"Save Changes\"}\n              </Button>\n            </DialogFooter>\n          </form>\n        </Form>\n      </DialogContent>\n    </Dialog>\n  );\n};\nexport default RenameDialog;\n"],"names":[],"mappings":";;;;AAAA;AAAA;AACA;AAGA;AACA;AAOA;AAAA;AAQA;AACA;AAAA;AAEA;;;;;;;;;;;AAQA,MAAM,eAAe,CAAC,EAAE,KAAK,EAAE,MAAM,EAAE,YAAY,EAAqB;;IACtE,MAAM,OAAO,CAAA,GAAA,0IAAA,CAAA,UAAO,AAAD;IACnB,MAAM,cAAc,CAAA,GAAA,yLAAA,CAAA,iBAAc,AAAD;IAEjC,MAAM,OAAO,CAAA,GAAA,iJAAA,CAAA,UAAO,AAAD,EAAE;QACnB,eAAe;YACb,OAAO,MAAM,KAAK;QACpB;QACA,QAAQ,uIAAA,CAAA,IAAC,CAAC,MAAM,CAAC;YACf,OAAO,uIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;QAC3B;IACF;IAEA,MAAM,cAAc,CAAA,GAAA,iLAAA,CAAA,cAAW,AAAD,EAC5B,KAAK,KAAK,CAAC,MAAM,CAAC,eAAe,CAAC;QAChC,SAAS;qDAAE;gBACT,MAAM,YAAY,iBAAiB,CAAC,KAAK,KAAK,CAAC,UAAU;gBACzD,2IAAA,CAAA,QAAK,CAAC,OAAO,CAAC;gBACd,aAAa;YACf;;QACA,OAAO;qDAAE,CAAC;gBACR,2IAAA,CAAA,QAAK,CAAC,KAAK,CACT,IAAI,IAAI,EAAE,SAAS,iBACf,4CACA;YAER;;IACF;IAGF,MAAM,WAAW,CAAC;QAChB,QAAQ,GAAG,CAAC,YAAY,MAAM;QAC9B,YAAY,MAAM,CAAC;YAAE,IAAI,MAAM,EAAE;YAAE,OAAO,KAAK,KAAK,CAAC,IAAI;QAAG;IAC9D;IAEA,qBACE,6LAAC,mIAAA,CAAA,SAAM;QAAC,MAAM;QAAQ,cAAc;kBAClC,cAAA,6LAAC,mIAAA,CAAA,gBAAa;;8BACZ,6LAAC,mIAAA,CAAA,eAAY;8BACX,cAAA,6LAAC,mIAAA,CAAA,cAAW;kCAAC;;;;;;;;;;;8BAEf,6LAAC,iJAAA,CAAA,OAAI;oBAAE,GAAG,IAAI;8BACZ,cAAA,6LAAC;wBAAK,UAAU,KAAK,YAAY,CAAC;;0CAChC,6LAAC;gCAAI,WAAU;0CACb,cAAA,6LAAC,iJAAA,CAAA,YAAS;oCACR,SAAS,KAAK,OAAO;oCACrB,MAAK;oCACL,QAAQ,CAAC,EAAE,KAAK,EAAE,iBAChB,6LAAC,iJAAA,CAAA,WAAQ;4CAAC,WAAU;;8DAClB,6LAAC,iJAAA,CAAA,YAAS;oDAAC,WAAU;8DAAa;;;;;;8DAClC,6LAAC,iJAAA,CAAA,cAAW;8DACV,cAAA,6LAAC,kIAAA,CAAA,QAAK;wDAAE,GAAG,KAAK;wDAAE,WAAU;wDAAa,SAAS;;;;;;;;;;;;;;;;;;;;;;;;;;;0CAM5D,6LAAC,mIAAA,CAAA,eAAY;;kDACX,6LAAC,mIAAA,CAAA,SAAM;wCACL,MAAK;wCACL,SAAQ;wCACR,SAAS,IAAM,aAAa;kDAC7B;;;;;;kDAGD,6LAAC,mIAAA,CAAA,SAAM;wCAAC,MAAK;wCAAS,UAAU,YAAY,SAAS;kDAClD,YAAY,SAAS,GAAG,cAAc;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQvD;GA1EM;;QACS,0IAAA,CAAA,UAAO;QACA,yLAAA,CAAA,iBAAc;QAErB,iJAAA,CAAA,UAAO;QASA,iLAAA,CAAA,cAAW;;;KAb3B;uCA2ES","debugId":null}},
    {"offset": {"line": 1243, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1249, "column": 0}, "map": {"version":3,"sources":["file:///Users/andreicruceru/comment.video/apps/nextjs/src/app/%28dashboard%29/_components/video-list/video-card.tsx"],"sourcesContent":["import React, { useState } from \"react\";\nimport Link from \"next/link\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { formatRelative } from \"date-fns\";\n\nimport { RouterOutputs } from \"@acme/api\";\nimport { toast } from \"@acme/ui/toast\";\n\nimport { useTRPC } from \"~/trpc/react\";\nimport { getCDNUrl } from \"~/utils/cdn\";\nimport { VideoActionsDropdown } from \"./video-actions-dropdown\";\nimport RenameDialog from \"./video-rename-dialog\";\n\nexport const VideoCard = (props: {\n  video: RouterOutputs[\"video\"][\"all\"][number];\n}) => {\n  const { video } = props;\n  const [isRenameDialogOpen, setIsRenameDialogOpen] = useState(false);\n\n  const trpc = useTRPC();\n  const queryClient = useQueryClient();\n\n  const deletePost = useMutation(\n    trpc.video.delete.mutationOptions({\n      onSuccess: async () => {\n        await queryClient.invalidateQueries(trpc.video.pathFilter());\n        toast.success(\"Video deleted successfully\");\n      },\n      onError: (err) => {\n        toast.error(\n          err.data?.code === \"UNAUTHORIZED\"\n            ? \"You must be logged in to delete a post\"\n            : \"Failed to delete post\",\n        );\n      },\n    }),\n  );\n\n  const handleRename = () => {\n    setIsRenameDialogOpen(true);\n  };\n\n  return (\n    <>\n      <Link href={`/video/${video.id}`}>\n        <div className=\"flex gap-2 rounded-md border hover:bg-accent\">\n          {video.url && (\n            <video\n              className=\"h-24 w-32 rounded-md object-cover\"\n              src={getCDNUrl(video.url)}\n            />\n          )}\n\n          <div className=\"p-2\">\n            <p className=\"text-lg font-semibold tracking-tighter\">\n              {video.title}\n            </p>\n            <p className=\"text-sm text-muted-foreground\">\n              {formatRelative(video.createdAt, new Date())}\n            </p>\n          </div>\n\n          <div className=\"ml-auto p-2\">\n            <VideoActionsDropdown\n              videoId={video.id}\n              onRename={handleRename}\n              onDelete={() => deletePost.mutate(video.id)}\n            />\n          </div>\n        </div>\n      </Link>\n\n      <RenameDialog\n        video={video}\n        isOpen={isRenameDialogOpen}\n        onOpenChange={setIsRenameDialogOpen}\n      />\n    </>\n  );\n};\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AAAA;AACA;AAGA;AAAA;AAEA;AACA;AACA;AACA;;;;;;;;;;;;AAEO,MAAM,YAAY,CAAC;;IAGxB,MAAM,EAAE,KAAK,EAAE,GAAG;IAClB,MAAM,CAAC,oBAAoB,sBAAsB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAE7D,MAAM,OAAO,CAAA,GAAA,0IAAA,CAAA,UAAO,AAAD;IACnB,MAAM,cAAc,CAAA,GAAA,yLAAA,CAAA,iBAAc,AAAD;IAEjC,MAAM,aAAa,CAAA,GAAA,iLAAA,CAAA,cAAW,AAAD,EAC3B,KAAK,KAAK,CAAC,MAAM,CAAC,eAAe,CAAC;QAChC,SAAS;iDAAE;gBACT,MAAM,YAAY,iBAAiB,CAAC,KAAK,KAAK,CAAC,UAAU;gBACzD,2IAAA,CAAA,QAAK,CAAC,OAAO,CAAC;YAChB;;QACA,OAAO;iDAAE,CAAC;gBACR,2IAAA,CAAA,QAAK,CAAC,KAAK,CACT,IAAI,IAAI,EAAE,SAAS,iBACf,2CACA;YAER;;IACF;IAGF,MAAM,eAAe;QACnB,sBAAsB;IACxB;IAEA,qBACE;;0BACE,6LAAC,+JAAA,CAAA,UAAI;gBAAC,MAAM,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;0BAC9B,cAAA,6LAAC;oBAAI,WAAU;;wBACZ,MAAM,GAAG,kBACR,6LAAC;4BACC,WAAU;4BACV,KAAK,CAAA,GAAA,wIAAA,CAAA,YAAS,AAAD,EAAE,MAAM,GAAG;;;;;;sCAI5B,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAE,WAAU;8CACV,MAAM,KAAK;;;;;;8CAEd,6LAAC;oCAAE,WAAU;8CACV,CAAA,GAAA,gJAAA,CAAA,iBAAc,AAAD,EAAE,MAAM,SAAS,EAAE,IAAI;;;;;;;;;;;;sCAIzC,6LAAC;4BAAI,WAAU;sCACb,cAAA,6LAAC,iNAAA,CAAA,uBAAoB;gCACnB,SAAS,MAAM,EAAE;gCACjB,UAAU;gCACV,UAAU,IAAM,WAAW,MAAM,CAAC,MAAM,EAAE;;;;;;;;;;;;;;;;;;;;;;0BAMlD,6LAAC,8MAAA,CAAA,UAAY;gBACX,OAAO;gBACP,QAAQ;gBACR,cAAc;;;;;;;;AAItB;GAlEa;;QAME,0IAAA,CAAA,UAAO;QACA,yLAAA,CAAA,iBAAc;QAEf,iLAAA,CAAA,cAAW;;;KATnB","debugId":null}},
    {"offset": {"line": 1389, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1395, "column": 0}, "map": {"version":3,"sources":["file:///Users/andreicruceru/comment.video/apps/nextjs/src/app/%28dashboard%29/_components/video-list/video-list.tsx"],"sourcesContent":["\"use client\";\n\nimport React from \"react\";\nimport { useSuspenseQuery } from \"@tanstack/react-query\";\n\nimport { useTRPC } from \"~/trpc/react\";\nimport { VideoCard } from \"./video-card\";\n\nexport const VideoList = () => {\n  const trpc = useTRPC();\n  const { data: videos } = useSuspenseQuery(trpc.video.all.queryOptions());\n\n  if (videos.length === 0) {\n    return null;\n  }\n\n  return (\n    <div className=\"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3\">\n      {videos.map((video) => {\n        return <VideoCard key={video.id} video={video} />;\n      })}\n    </div>\n  );\n};\n"],"names":[],"mappings":";;;;AAGA;AAEA;AACA;;;AANA;;;;AAQO,MAAM,YAAY;;IACvB,MAAM,OAAO,CAAA,GAAA,0IAAA,CAAA,UAAO,AAAD;IACnB,MAAM,EAAE,MAAM,MAAM,EAAE,GAAG,CAAA,GAAA,sLAAA,CAAA,mBAAgB,AAAD,EAAE,KAAK,KAAK,CAAC,GAAG,CAAC,YAAY;IAErE,IAAI,OAAO,MAAM,KAAK,GAAG;QACvB,OAAO;IACT;IAEA,qBACE,6LAAC;QAAI,WAAU;kBACZ,OAAO,GAAG,CAAC,CAAC;YACX,qBAAO,6LAAC,kMAAA,CAAA,YAAS;gBAAgB,OAAO;eAAjB,MAAM,EAAE;;;;;QACjC;;;;;;AAGN;GAfa;;QACE,0IAAA,CAAA,UAAO;QACK,sLAAA,CAAA,mBAAgB;;;KAF9B","debugId":null}},
    {"offset": {"line": 1444, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}